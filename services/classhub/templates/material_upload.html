<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Upload - {{ material.title }}</title>
    {% include "includes/glass_theme.html" %}
    <style>
      .shell {
        max-width: 940px;
      }
      .top h1 {
        margin: 6px 0 0 0;
        font-size: clamp(1.8rem, 2.6vw, 2.25rem);
      }
      input[type="file"] {
        display: block;
        margin-top: 8px;
      }
      .err {
        color: #8a1f1f;
        background: rgba(255, 224, 224, 0.58);
        padding: 10px;
        border-radius: 10px;
        border: 1px solid rgba(182, 56, 56, 0.35);
        margin-top: 12px;
      }
    </style>
  </head>
  <body class="glass-theme">
    <a class="skip-link" href="#main-content">Skip to main content</a>
    <div class="shell">
      <main id="main-content">
        <div class="top">
          <div>
            <div class="muted"><a href="/student">Back to class</a> · <a href="/logout">Log out</a></div>
            <h1>{{ material.title }}</h1>
            <div class="muted">Signed in as <strong>{{ student.display_name }}</strong> · {{ classroom.name }}</div>
          </div>
        </div>

        <div class="card">
          <h2 style="margin:0">Upload your work</h2>
          <p class="muted" style="margin-top:8px">Allowed: <strong>{{ allowed_exts|join:", " }}</strong> · Max <strong>{{ material.max_upload_mb }}MB</strong></p>
          {% if upload_locked %}
            <p class="muted" style="margin-top:8px">
              Submissions open on <strong>{{ upload_available_on|date:"M j, Y" }}</strong>. You can review prior uploads below.
            </p>
          {% endif %}

          {% if error %}
            <div class="err" role="alert" aria-live="assertive">{{ error }}</div>
          {% endif %}

          {% if not upload_locked %}
            <form method="post" enctype="multipart/form-data" style="margin-top:12px">
              {% csrf_token %}
              {{ form.file }}
              <div style="margin-top:10px">{{ form.note }}</div>
              <button type="submit">Upload</button>
            </form>
          {% endif %}
        </div>

        <div class="card">
          <h2 style="margin:0">Your uploads</h2>
          {% if submissions %}
            <table style="margin-top:10px">
              <thead>
                <tr>
                  <th scope="col">When</th>
                  <th scope="col">File</th>
                  <th scope="col">Download</th>
                </tr>
              </thead>
              <tbody>
                {% for s in submissions %}
                  <tr>
                    <td class="muted">{{ s.uploaded_at }}</td>
                    <td>{{ s.original_filename }}</td>
                    <td><a href="/submission/{{ s.id }}/download">Download</a></td>
                  </tr>
                  {% if s.note %}
                    <tr>
                      <td></td>
                      <td colspan="2" class="muted">Note: {{ s.note }}</td>
                    </tr>
                  {% endif %}
                {% endfor %}
              </tbody>
            </table>
          {% else %}
            <p class="muted" style="margin-top:10px">No uploads yet.</p>
          {% endif %}
        </div>
      </main>
    </div>
  </body>
</html>
